{
    "variable_modification": {
        "type": "object",
        "description": "Schema for the ion_channel_variable_modification UI element. Used to modify both RANGE and GLOBAL NMODL variables. The UI presents a two-step flow: Step 1 selects a variable from a grouped dropdown (ion channel -> variable), Step 2 shows a single numeric input for the new value.",
        "properties": {
            "ui_element": {
                "type": "string",
                "const": "ion_channel_variable_modification",
                "description": "Must be 'ion_channel_variable_modification'."
            },
            "title": {
                "type": "string",
                "description": "Title of the modification field shown in the UI."
            },
            "description": {
                "type": "string",
                "description": "Description of the modification field shown in the UI."
            },
            "property_group": {
                "type": "string",
                "const": "Circuit",
                "description": "The property group used to fetch available variables. Must be 'Circuit'."
            },
            "property": {
                "type": "string",
                "const": "MechanismVariablesByIonChannel",
                "description": "The mapped circuit property key used to populate the variable dropdown. Must be 'MechanismVariablesByIonChannel'."
            }
        },
        "required": ["ui_element", "title", "description", "property_group", "property"],
        "data_model": {
            "description": "The data model for the ByNeuronModification object that this UI element populates.",
            "type": "object",
            "properties": {
                "ion_channel_id": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Entity ID of the ion channel. Set automatically when the user selects a variable."
                },
                "channel_name": {
                    "type": "string",
                    "minLength": 1,
                    "description": "Channel suffix (e.g., 'NaTg') used as key in conditions.mechanisms."
                },
                "variable_name": {
                    "type": "string",
                    "description": "Name of the variable selected by the user (e.g., 'gCa_HVAbar_Ca_HVA2' for RANGE, 'ena_NaTg' for GLOBAL)."
                },
                "variable_type": {
                    "type": "string",
                    "enum": ["RANGE", "GLOBAL"],
                    "default": "GLOBAL",
                    "description": "Variable type: 'RANGE' (section-specific) or 'GLOBAL' (neuron-wide)."
                },
                "new_value": {
                    "description": "New value(s) that applies to the entire neuron (for GLOBAL) or all sections uniformly (for RANGE).",
                    "oneOf": [
                        {"type": "number"},
                        {"type": "array", "items": {"type": "number"}}
                    ]
                }
            },
            "required": ["ion_channel_id", "channel_name", "variable_name", "variable_type", "new_value"]
        },
        "sonata_output": {
            "description": "SONATA configuration entries generated by this block. For RANGE variables: conditions.modifications list using configure_all_sections. For GLOBAL variables: conditions.mechanisms dict.",
            "examples": {
                "global": {
                    "conditions": {
                        "mechanisms": {
                            "NaTg": {
                                "ena_NaTg": 50.0
                            }
                        }
                    }
                },
                "range": {
                    "conditions": {
                        "modifications": [
                            {
                                "name": "modify_gamma_CaDynamics_DC0_all",
                                "node_set": "single",
                                "type": "configure_all_sections",
                                "section_configure": "%s.gamma_CaDynamics_DC0 = 0"
                            }
                        ]
                    }
                }
            }
        }
    }
}
